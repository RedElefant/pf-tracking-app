<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Workout Tracker</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 10px;
      background-color: #f9f9f9;
    }

    h2 {
      text-align: center;
      margin-top: 20px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      table-layout: fixed;
      font-size: 14px;
      margin-bottom: 20px;
      background: white;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      border-radius: 6px;
      overflow: hidden;
    }

    th, td {
      border: 1px solid #ccc;
      padding: 6px;
      text-align: center;
      word-wrap: break-word;
    }

    th {
      background-color: #d7bde2;
      color: #333;
    }

    button {
      display: block;
      margin: 15px auto;
      padding: 10px 16px;
      background-color: #d7bde2;
      color: #333;
      border: none;
      border-radius: 6px;
      font-size: 14px;
      cursor: pointer;
    }

    button:hover {
      background-color: #c39bd3;
    }

    .history {
      margin-top: 20px;
      display: none;
    }

    /* Responsive tweaks */
    @media (max-width: 600px) {
      table { font-size: 12px; }
      th, td { padding: 4px; }
      th span.long-label { display: none; }
      th span.short-label { display: inline; }
    }

    @media (min-width: 601px) {
      th span.short-label { display: none; }
      th span.long-label { display: inline; }
    }
  </style>
</head>
<body>
  <h2>Day 1</h2>
  <table id="day1"></table>

  <h2>Day 2</h2>
  <table id="day2"></table>

  <h2>Day 3</h2>
  <table id="day3"></table>

  <button onclick="toggleHistory()">View History</button>

  <div class="history" id="history">
    <h2>Workout History</h2>
    <div id="historyContent"></div>
  </div>

  <script>
    const workouts = {
      day1: [
        "Chest Press Machine", "Lat Pulldown Machine", "Shoulder Press Machine",
        "Torso Rotation Machine (per side)", "Abdominal Crunch Machine",
        "Leg Press Machine", "Leg Curl Machine", "Lunge Machine"
      ],
      day2: [
        "Incline Chest Press Machine", "Seated Row Machine", "Pec Deck Fly Machine",
        "Back Extension Machine", "Hip Abduction Machine", "Hip Adduction Machine",
        "Calf Raise Machine", "Glute Kickback Machine"
      ],
      day3: [
        "Shoulder Press Machine", "Torso Rotation Machine (per side)", "Abdominal Crunch Machine",
        "Bicep Curl Machine", "Tricep Extension Machine", "Seated Dip Machine",
        "Rear Delt Fly (Reverse Pec Deck)", "Dumbbell Lateral Raise"
      ]
    };

    const setsOptions = [2, 3, 4];
    const repsOptions = Array.from({length: 7}, (_, i) => 8 + i * 2); // 8 to 20 step 2
    const weightOptions = Array.from({length: 11}, (_, i) => 20 + i * 10); // 20 to 120

    const dbKey = "workoutHistory";

    function createDropdown(options, id, savedValue, defaultValue) {
      const select = document.createElement("select");
      select.id = id;
      options.forEach(opt => {
        const option = document.createElement("option");
        option.value = opt;
        option.textContent = opt;
        if (savedValue == opt) option.selected = true;
        select.appendChild(option);
      });
      if (!savedValue) select.value = defaultValue;
      return select;
    }

    function renderTables() {
      Object.keys(workouts).forEach(day => {
        const table = document.getElementById(day);
        table.innerHTML = `
          <tr>
            <th><span class="long-label">Exercise</span><span class="short-label">Ex</span></th>
            <th><span class="long-label">Sets</span><span class="short-label">S</span></th>
            <th><span class="long-label">Reps</span><span class="short-label">R</span></th>
            <th><span class="long-label">Weight</span><span class="short-label">Wt</span></th>
            <th><span class="long-label">Done</span><span class="short-label">âœ“</span></th>
          </tr>
        `;

        workouts[day].forEach(exercise => {
          const row = document.createElement("tr");

          const exerciseCell = document.createElement("td");
          exerciseCell.textContent = exercise;
          row.appendChild(exerciseCell);

          const setsCell = document.createElement("td");
          setsCell.appendChild(createDropdown(setsOptions, `${day}_${exercise}_sets`, loadLast(day, exercise, "sets"), setsOptions[0]));
          row.appendChild(setsCell);

          const repsCell = document.createElement("td");
          repsCell.appendChild(createDropdown(repsOptions, `${day}_${exercise}_reps`, loadLast(day, exercise, "reps"), repsOptions[0]));
          row.appendChild(repsCell);

          const weightCell = document.createElement("td");
          weightCell.appendChild(createDropdown(weightOptions, `${day}_${exercise}_weight`, loadLast(day, exercise, "weight"), weightOptions[0]));
          row.appendChild(weightCell);

          const doneCell = document.createElement("td");
          const checkbox = document.createElement("input");
          checkbox.type = "checkbox";
          checkbox.id = `${day}_${exercise}_done`;
          doneCell.appendChild(checkbox);
          row.appendChild(doneCell);

          table.appendChild(row);
        });
      });
    }

    function loadLast(day, exercise, field) {
      const history = JSON.parse(localStorage.getItem(dbKey)) || [];
      for (let i = history.length - 1; i >= 0; i--) {
        const e = history[i];
        if (e.day === day && e.exercise === exercise && e[field]) {
          return e[field];
        }
      }
      return null;
    }

    function saveProgress() {
      const history = JSON.parse(localStorage.getItem(dbKey)) || [];
      Object.keys(workouts).forEach(day => {
        workouts[day].forEach(exercise => {
          const done = document.getElementById(`${day}_${exercise}_done`).checked;
          if (done) {
            history.push({
              day,
              exercise,
              sets: document.getElementById(`${day}_${exercise}_sets`).value,
              reps: document.getElementById(`${day}_${exercise}_reps`).value,
              weight: document.getElementById(`${day}_${exercise}_weight`).value,
              date: new Date().toLocaleDateString()
            });
          }
        });
      });
      localStorage.setItem(dbKey, JSON.stringify(history));
    }

    function toggleHistory() {
      const historyDiv = document.getElementById("history");
      const contentDiv = document.getElementById("historyContent");
      if (historyDiv.style.display === "none" || historyDiv.style.display === "") {
        saveProgress();
        const history = JSON.parse(localStorage.getItem(dbKey)) || [];
        contentDiv.innerHTML = history.map(h =>
          `<div>${h.date} - ${h.day} - ${h.exercise}: ${h.sets}x${h.reps} @ ${h.weight} lbs</div>`
        ).join("");
        historyDiv.style.display = "block";
      } else {
        historyDiv.style.display = "none";
      }
    }

    renderTables();
  </script>
</body>
</html>
