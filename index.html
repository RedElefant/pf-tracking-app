<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>PF Total Body Circuit</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f9f9f9;
      margin: 0;
      padding: 0;
    }
    h2 {
      text-align: center;
      margin-top: 1rem;
      color: #333;
    }
    .button-container {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin: 15px 0;
    }
    button {
      background-color: #d7bde2;
      border: none;
      border-radius: 8px;
      padding: 10px 16px;
      font-size: 14px;
      color: #333;
      font-weight: bold;
      cursor: pointer;
    }
    button:hover {
      background-color: #c39bd3;
    }
    table {
      width: 95%;
      margin: 0 auto 20px auto;
      border-collapse: collapse;
      font-size: 14px;
    }
    th {
      background-color: #d7bde2;
      color: #333;
      padding: 8px;
      text-align: center;
    }
    td {
      padding: 6px;
      text-align: center;
      border-bottom: 1px solid #ddd;
    }
    select {
      padding: 4px;
      font-size: 14px;
    }
    .history, .summary {
      display: none;
      margin: 20px;
    }
    .history h3, .summary h3 {
      text-align: center;
    }
  </style>
</head>
<body>

  <h2>PF Total Body Circuit</h2>

  <div class="button-container">
    <button onclick="toggleView('history')">View History</button>
    <button onclick="toggleView('summary')">Weekly Summary</button>
  </div>

  <div id="tables"></div>
  <div class="history" id="historyView">
    <h3>Workout History</h3>
    <div id="historyContent"></div>
  </div>
  <div class="summary" id="summaryView">
    <h3>Weekly Summary</h3>
    <div id="summaryContent"></div>
  </div>

  <script>
    const exercises = {
      "Day 1": [
        "Chest Press Machine",
        "Back Extension Machine",
        "Lat Pulldown Machine",
        "Seated Row Machine",
        "Abdominal Crunch Machine",
        "Torso Rotation Machine (per side)",
        "Pec Deck (Butterfly) Machine"
      ],
      "Day 2": [
        "Leg Press Machine",
        "Seated Leg Curl Machine",
        "Leg Extension Machine",
        "Calf Extension Machine",
        "Abdominal Crunch Machine",
        "Hip Abduction Machine",
        "Hip Adduction Machine",
        "Lunge Machine"
      ],
      "Day 3": [
        "Shoulder Press Machine",
        "Torso Rotation Machine (per side)",
        "Abdominal Crunch Machine",
        "Bicep Curl Machine",
        "Tricep Extension Machine",
        "Seated Dip Machine",
        "Rear Delt Fly (Reverse Pec Deck)",
        "Dumbbell Lateral Raise"
      ]
    };

    const repOptions = Array.from({length: 7}, (_,i) => 8 + i*2); // 8–20
    const weightOptions = Array.from({length: 11}, (_,i) => 20 + i*10); // 20–120
    let history = JSON.parse(localStorage.getItem('workoutHistory')) || [];
    let lastSelections = JSON.parse(localStorage.getItem('lastSelections')) || {};

    function renderTables() {
      const container = document.getElementById("tables");
      container.innerHTML = "";

      Object.keys(exercises).forEach(day => {
        const table = document.createElement("table");
        const caption = document.createElement("caption");
        caption.innerHTML = `<h3>${day}</h3>`;
        table.appendChild(caption);

        const header = document.createElement("tr");
        ["Exercise","Sets","Reps","Weight","Done"].forEach(h => {
          const th = document.createElement("th");
          th.textContent = h;
          header.appendChild(th);
        });
        table.appendChild(header);

        exercises[day].forEach(ex => {
          const tr = document.createElement("tr");

          const tdEx = document.createElement("td");
          tdEx.textContent = ex;
          tr.appendChild(tdEx);

          const tdSets = document.createElement("td");
          tdSets.textContent = "3";
          tr.appendChild(tdSets);

          const tdReps = document.createElement("td");
          const repSelect = document.createElement("select");
          repOptions.forEach(val => {
            const opt = document.createElement("option");
            opt.value = val;
            opt.textContent = val;
            repSelect.appendChild(opt);
          });
          repSelect.value = lastSelections[ex]?.reps || repOptions[0];
          tdReps.appendChild(repSelect);
          tr.appendChild(tdReps);

          const tdWeight = document.createElement("td");
          const weightSelect = document.createElement("select");
          weightOptions.forEach(val => {
            const opt = document.createElement("option");
            opt.value = val;
            opt.textContent = val;
            weightSelect.appendChild(opt);
          });
          weightSelect.value = lastSelections[ex]?.weight || weightOptions[0];
          tdWeight.appendChild(weightSelect);
          tr.appendChild(tdWeight);

          const tdDone = document.createElement("td");
          const chk = document.createElement("input");
          chk.type = "checkbox";
          chk.onchange = () => {
            if (chk.checked) {
              const entry = {
                date: new Date().toLocaleDateString(),
                day,
                exercise: ex,
                sets: 3,
                reps: repSelect.value,
                weight: weightSelect.value
              };
              history.push(entry);
              localStorage.setItem('workoutHistory', JSON.stringify(history));
              lastSelections[ex] = { reps: repSelect.value, weight: weightSelect.value };
              localStorage.setItem('lastSelections', JSON.stringify(lastSelections));
            }
          };
          tdDone.appendChild(chk);
          tr.appendChild(tdDone);

          table.appendChild(tr);
        });
        container.appendChild(table);
      });
    }

    function toggleView(view) {
      document.getElementById("historyView").style.display = "none";
      document.getElementById("summaryView").style.display = "none";
      document.getElementById("tables").style.display = "none";

      if (view === "history") {
        document.getElementById("historyView").style.display = "block";
        renderHistory();
      } else if (view === "summary") {
        document.getElementById("summaryView").style.display = "block";
        renderSummary();
      } else {
        document.getElementById("tables").style.display = "block";
      }
    }

    function renderHistory() {
      const content = document.getElementById("historyContent");
      content.innerHTML = "";
      history.forEach(entry => {
        const div = document.createElement("div");
        div.textContent = `${entry.date} - ${entry.day} - ${entry.exercise} | Sets: ${entry.sets}, Reps: ${entry.reps}, Weight: ${entry.weight}`;
        content.appendChild(div);
      });
    }

    function renderSummary() {
      const content = document.getElementById("summaryContent");
      content.innerHTML = "";
      const summary = {};
      history.forEach(entry => {
        if (!summary[entry.exercise]) {
          summary[entry.exercise] = [];
        }
        summary[entry.exercise].push(entry);
      });
      Object.keys(summary).forEach(ex => {
        const div = document.createElement("div");
        const avgWeight = (summary[ex].reduce((acc,e)=>acc+parseInt(e.weight),0)/summary[ex].length).toFixed(1);
        div.textContent = `${ex} - Sessions: ${summary[ex].length}, Avg Weight: ${avgWeight}`;
        content.appendChild(div);
      });
    }

    renderTables();
  </script>
</body>
</html>
